<!DOCTYPE html>
<html>
<head>
    <title>Тест изображений CORS</title>
</head>
<body>
    <h1>Тест загрузки изображений</h1>
    
    <h2>Прямая ссылка на изображение:</h2>
    <img 
        id="testImg" 
        src="http://localhost:5000/uploads/image-1755466870533-661224000.jpg" 
        alt="Тестовое изображение"
        style="max-width: 300px; border: 1px solid #ccc;"
        onload="console.log('✅ Изображение загружено успешно')"
        onerror="console.log('❌ Ошибка загрузки изображения:', this.src)"
    />
    
    <h2>JavaScript проверка:</h2>
    <button onclick="testImageLoad()">Тест загрузки через JS</button>
    <div id="result"></div>
    
    <script>
        async function testImageLoad() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Тестируем...';
            
            try {
                // Тестируем fetch запрос
                console.log('Тестируем fetch запрос...');
                const response = await fetch('http://localhost:5000/uploads/image-1755466870533-661224000.jpg');
                console.log('Response status:', response.status);
                console.log('Response headers:');
                response.headers.forEach((value, key) => {
                    console.log(`  ${key}: ${value}`);
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<p style="color: green;">✅ Fetch запрос успешен!</p>';
                } else {
                    resultDiv.innerHTML = '<p style="color: red;">❌ Fetch запрос неуспешен: ' + response.status + '</p>';
                }
            } catch (error) {
                console.error('Ошибка fetch:', error);
                resultDiv.innerHTML = '<p style="color: red;">❌ Ошибка: ' + error.message + '</p>';
            }
        }
        
        // Автоматический тест при загрузке страницы
        window.addEventListener('load', () => {
            console.log('Страница загружена, тестируем изображение...');
            testImageLoad();
        });
    </script>
</body>
</html>